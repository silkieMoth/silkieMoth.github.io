[
  {
    "objectID": "resources.html",
    "href": "resources.html",
    "title": "The Resources Page.",
    "section": "",
    "text": "Here are some of the projects I’ve completed as a student at UCSB:\n\n\nFire Scars from the 2017 Thomas Fire in Santa Barbara and Ventura\nThe Biodiverisity Intactness Index and Biodiveristy Decline in Phoenix, AZ\nCreation of A Habitat Suitability Map Function for the California Coast\nHouston 2021 Blackout Analysis"
  },
  {
    "objectID": "posts/eds_222_final_proj_bees/index.html",
    "href": "posts/eds_222_final_proj_bees/index.html",
    "title": "Pesticides and Bee Biodiversity at the Golden Coast",
    "section": "",
    "text": "Bees and other pollinators are extremely valuable for the ecosystem services they provide. Yet, throughout the past few decades, they have declined in both population and biodiversity (Goulson et al, 2015). Attributed factors are invasive parasites (Meeus et al, 2011), climate change (Soroye, Newbold, & Kerr, 2020), habitat destruction (and fragmentation (Aizen & Feinsinger, 1994), and pesticide use (Arena & Sgolastra, 2014).\nSeveral factor’s make California an ideal microcosm to analyze the effect of pesticides on bee biodiversity.\n\nThe state’s 1989 Food Safety Act requires uniquely high standards for reporting (California DPR, 2023). Pesticide use datasets out of CA are therefore large and highly detailed.\nCA is size means it has many different ecosystems contained within the same political boundaries.\nCA is a agricultural hotspot in the country, meaning there are areas of intensive pesticide use.\n\nTherefore in this analysis, we will be analyzing pesticide use. Later, we introduce another variable, land cover, to see if there is a significant effect.\n\n\nPesticide use map by county, with bee species points overlaid. Most points are concentrated within Bay Area, Los Angeles, and San Diego.\n\n\n\n\nCreation of two error models\n\nA two variable model between biodiversity and pesticide use.\nAn extrapolation of the previous model with an added predictor of land cover.\n\nDiagnosing spatial autocorrelation in our models by running a lag model on the residuals and finding Moran’s I.\nA hypothesis test for the affect of land cover on the model where we rejected the null.\n\n\n\n\nAll code for this project can be accessed here."
  },
  {
    "objectID": "posts/eds_222_final_proj_bees/index.html#key-highlights",
    "href": "posts/eds_222_final_proj_bees/index.html#key-highlights",
    "title": "Pesticides and Bee Biodiversity at the Golden Coast",
    "section": "",
    "text": "Creation of two error models\n\nA two variable model between biodiversity and pesticide use.\nAn extrapolation of the previous model with an added predictor of land cover.\n\nDiagnosing spatial autocorrelation in our models by running a lag model on the residuals and finding Moran’s I.\nA hypothesis test for the affect of land cover on the model where we rejected the null."
  },
  {
    "objectID": "posts/eds_222_final_proj_bees/index.html#repository-link",
    "href": "posts/eds_222_final_proj_bees/index.html#repository-link",
    "title": "Pesticides and Bee Biodiversity at the Golden Coast",
    "section": "",
    "text": "All code for this project can be accessed here."
  },
  {
    "objectID": "posts/eds_222_final_proj_bees/index.html#reflection",
    "href": "posts/eds_222_final_proj_bees/index.html#reflection",
    "title": "Pesticides and Bee Biodiversity at the Golden Coast",
    "section": "Reflection",
    "text": "Reflection\nWhile I hypothesized that we would see a significant effect between biodiversity and pesticide use, we didn’t. There are several possible reasons for this.\n\n1. Complexity of ecological forces\n\nWhile it remains true that bee populations are in decline, it’s also a somewhat complicated topic. For one, not all bee species are equally vulnerable. Bumblebee’s longer flight ranges and bigger bodies allow them to tough out the dredge of a long flight from one isolate habitat patch to another and the toxicity of pesticides better than honeybees do (Greenleaf et al, 2007). Furthermore, bees have shown to have a significant amount of phenotypic plasticity, in which they are able to modify their behavior according to their environment (Corona, Libbrecht, & Wheeler, 2016). Furthermore, a significant amount of invasive pressure comes from other bees - the European Honeybee.\n\n\n\n2. Analysis biases\n\nPoor data precision\n\nDisappointingly, the pesticide data, in spite of all it’s detail, did not have a column on it in order to join with the shapefile that came with it by township. This possibly affected the results of this analysis, as all the data, even if it was originally in great detail, had to be aggregated up to the county level.\nThe hypothesis test was notable as it was likely flawed. For one, I was not able to use an error model due to a strange error in the hypothesis test. Secondly, my p-statistic was suspiciously low.\n\n\n\n\n3. Data biases\n\nUneven distribution of data points\n\nBig Bee, a database that contains data from a multitude of sources is unlikely to have it’s data be distributed evenly in space for if no other reason that data is more likely to be collected where people already are. It has many different partner and sources but it also collects research grade iNaturalist observations meaning it’s possible there will be less observations out in the middle of the desert and more in a popular park and picnic spot."
  },
  {
    "objectID": "posts/eds_222_final_proj_bees/index.html#possible-next-steps",
    "href": "posts/eds_222_final_proj_bees/index.html#possible-next-steps",
    "title": "Pesticides and Bee Biodiversity at the Golden Coast",
    "section": "Possible Next Steps",
    "text": "Possible Next Steps\nBee ecology and decline is a complex topic and there is still much left to learn. Ways I could continue this analysis include…\n\n1. Refine this analysis and correct possible mistakes\n\nThere are a multitude of ways this analysis could be improved.\n\nHow do we visualize the pesticide data with more precision? It’s possible there is something I missed, and the CA DPR may be able to help. Being about to accomplish this could lead to more interesting results than the ones obtained here.\nAnother possibility is to apply a logistic regression model to the land_cover variable. Because it’s the variable that appears to be most significantly correlated, it could be investigated further. Because it is such a high resolution dataset with many different land types, it may warrant it’s own analysis.\n\n\n\n\n2. Investigate other variables\n\nVariables such as the influence of parasites and climate change are things that weren’t at all included in this analysis. Invasive parasites have been cited as being a notable contributor to colony collapse disorder (Meeus et al, 2011), and climate change continues to have it’s own negative effects (Soroye, Newbold, & Kerr, 2020).\n\n\n\n3. Possible interactions with non-bee factors\n\nThe environment is confusing and wild, and nothing will ever make sense to us but that makes it all the more beautiful. Of course, this won’t stop us from trying. Is sea level rise affecting a particular taxa’s favorite flower? Is there some stochastic connection between bee activity and monarch migration? These are things we can only know if they’re investigated."
  },
  {
    "objectID": "DELETE_LATER/practice.html",
    "href": "DELETE_LATER/practice.html",
    "title": "practice",
    "section": "",
    "text": "Here is my level one header\nHere is my first paragraph\nHere is my second paragraph, where you can read more about MEDS.\nThis is very important text!"
  },
  {
    "objectID": "about - Copy.html",
    "href": "about - Copy.html",
    "title": "About",
    "section": "",
    "text": "I’ve done all these things!\n\nCorps Member with Americorps NCCC SW Region (Aurora, CO)\nCorps Member with CB Trust’s Chesapeake Conservation Corps, at my host org Interfaith Partner’s for the Chesapeake (Salisbury, MD)\nEnvironmental Technician with Maryland DNR (Swanton, MD)\nLand Steward with Friends of Hopewell Valley Open Space (Titusville, NJ)\nTortoise Transect Technician with Great Basin Institute (Las Vegas, NV)\nPinyon-Juniper Field Technician with UNLV and USFWS (Las Vegas, NV)"
  },
  {
    "objectID": "about - Copy.html#what-ive-done-for-work",
    "href": "about - Copy.html#what-ive-done-for-work",
    "title": "About",
    "section": "",
    "text": "I’ve done all these things!\n\nCorps Member with Americorps NCCC SW Region (Aurora, CO)\nCorps Member with CB Trust’s Chesapeake Conservation Corps, at my host org Interfaith Partner’s for the Chesapeake (Salisbury, MD)\nEnvironmental Technician with Maryland DNR (Swanton, MD)\nLand Steward with Friends of Hopewell Valley Open Space (Titusville, NJ)\nTortoise Transect Technician with Great Basin Institute (Las Vegas, NV)\nPinyon-Juniper Field Technician with UNLV and USFWS (Las Vegas, NV)"
  },
  {
    "objectID": "about - Copy.html#what-i-do-for-fun",
    "href": "about - Copy.html#what-i-do-for-fun",
    "title": "About",
    "section": "What I do for fun",
    "text": "What I do for fun\n\nfun stuff\n\nhere is some more text\n\nhere is a line\nanother"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I’ve done all these things!\n\nCorps Member with Americorps NCCC SW Region (Aurora, CO)\nCorps Member with CB Trust’s Chesapeake Conservation Corps, at my host org Interfaith Partner’s for the Chesapeake (Salisbury, MD)\nEnvironmental Technician with Maryland DNR (Swanton, MD)\nLand Steward with Friends of Hopewell Valley Open Space (Titusville, NJ)\nTortoise Transect Technician with Great Basin Institute (Las Vegas, NV)\nPinyon-Juniper Field Technician with UNLV and USFWS (Las Vegas, NV)"
  },
  {
    "objectID": "about.html#what-ive-done-for-work",
    "href": "about.html#what-ive-done-for-work",
    "title": "About",
    "section": "",
    "text": "I’ve done all these things!\n\nCorps Member with Americorps NCCC SW Region (Aurora, CO)\nCorps Member with CB Trust’s Chesapeake Conservation Corps, at my host org Interfaith Partner’s for the Chesapeake (Salisbury, MD)\nEnvironmental Technician with Maryland DNR (Swanton, MD)\nLand Steward with Friends of Hopewell Valley Open Space (Titusville, NJ)\nTortoise Transect Technician with Great Basin Institute (Las Vegas, NV)\nPinyon-Juniper Field Technician with UNLV and USFWS (Las Vegas, NV)"
  },
  {
    "objectID": "about.html#what-i-do-for-fun",
    "href": "about.html#what-i-do-for-fun",
    "title": "About",
    "section": "What I do for fun",
    "text": "What I do for fun\n\nI love whenever I can get some time with my guitar, maybe with some paper and a pencil to strech my creative side. I also love trying things I’ve never tried before, or getting outside and exploring places I have never seen or been to.\n\n\nAnyone is free to reach out if they ever want to go hiking or rock climbing!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Joshua Paul Cohen",
    "section": "",
    "text": "Hi there! I’m Joshua. I’m currently a Environmental Data Science student at the UCSN Bren School. But I also like bugs, music, hiking, rock climbing, and all the cool stuff."
  },
  {
    "objectID": "index.html#education",
    "href": "index.html#education",
    "title": "Joshua Paul Cohen",
    "section": "Education",
    "text": "Education\nMaster of Environmental Data Science (Expected June 2025) Bren School of Environmental Science & Management – University of California, Santa Barbara (UCSB)\nBachelor of Science in Environmental Science (May 2020)  Minors in Chesapeake Regional Studies, Music  Washington College (WAC), Chestertown, MD \n\nI’m currently looking to be hired!\nI have significant GIS experience, did my undergrad along the Cheaspeake Bay, and am motivated to use my skills to preserve the environment.\n\nSend me questions and inquiries at the below links if interested!"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Blog",
    "section": "",
    "text": "MacDonald et al. (2018) Breakdown\n\n\n\n\n\n\nJoshua Paul Cohen, Josh Mull, Amanda Overbye\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPesticides and Bee Biodiversity at the Golden Coast\n\n\n\nBees\n\n\nPesticides\n\n\nR\n\n\nGeospatial\n\n\nStatistics\n\n\n\nA data analysis of the effect of California’s pesticide use on Anthophila richness.\n\n\n\nJoshua Paul Cohen\n\n\nDec 19, 2024\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/macdonald_2018_breakdown/index.html",
    "href": "posts/macdonald_2018_breakdown/index.html",
    "title": "MacDonald et al. (2018) Breakdown",
    "section": "",
    "text": "When it comes to insect and invert borne zoonotic diseases, edge forest habitat is thought of in the literature to be high risk. But because the worlds forests are only getting more fragmented, the area of edge forest is increasing. Lyme disease particularly, has been found to be a major offender, as the land type lends itself well to strong tick vectors like deer.\nThis has been a strong motivator for studying Lyme disease incidence. If the wildlife-urban interface (WUI) is getting larger, it’s likely a result of people to live in those areas, and we may expect the rate of Lyme disease to rise. It’s for this reason that habitat fragmentation has logically been used as an indicator for incidence. But studies on this topic, while generally supporting this idea, have been inconsistent.\nMacDonald et al. (2018), suggests that the reason for this inconsistency could be an endogeneity bias, in which as much as habitat fragmentation influences Lyme prevalence, it also works the other way around, in which Lyme incidence influences where people choose to live, which ironically can lead to more fragmentation. This violates a very important assumption that makes most statistical models work, in which the predictor variables must not be correlated with the error term. Because this is the method used in most other studies on this topic, this suggest some bias in the literature.\nThey therefore try a different approach, and instead use an instrumental variable (IV) model. An IV is a variable that correlates with the predictor variable in a model. We refer to this as endogeneity, and the variable as our endogenous variable. This method can be used to predict Lyme disease by proximity, as habitat fragmentation on it’s own is unreliable.\nMacDonald et al. (2018) utilizes this concept by including a density restriction index, which indicates lot size regulation in an area. The thing about the instrumental variable approach to modeling is that it’s a 2 stage process where first, the instrument is regressed on our habitat fragmentation (our endogenous variable), and second, the the endogenous variable is regressed on the dependent variable (Lyme disease incidence). This is a very robust way performing this analysis.\nUsing this strategy, the paper attempts to model Lyme disease incidence in the WUI of the US northeastern deciduous forests. Along, with and IV approach, it uses a fixed effects approach and checks for robustness with several F-tests.\nlibrary(tidyverse)\nlibrary(ivreg)\nlibrary(plm)\nlibrary(jtools)\nlibrary(sandwich)\nlibrary(lmtest)\nlibrary(fixest)\nlibrary(kableExtra)\nlibrary(ivDiag)\n\nlyme &lt;- read_csv(here::here('posts', \n                            'macdonald_2018_breakdown', \n                            'data', \n                            'MacDonaldetal_JAE_2018.csv'))\nlyme_na &lt;- lyme %&gt;% filter(is.na(DensityResIndex) == FALSE)"
  },
  {
    "objectID": "posts/macdonald_2018_breakdown/index.html#workflow",
    "href": "posts/macdonald_2018_breakdown/index.html#workflow",
    "title": "MacDonald et al. (2018) Breakdown",
    "section": "Workflow",
    "text": "Workflow\n\nVariable names\n\n\n\n\n\n\n\n\nVariable\nRole in Model\nDescription\n\n\n\n\nDensityResIndex\nIV\nDensity restriction index, indicates the average lot size regulation for a given observation\n\n\nPercWuiPop\nEndogenous Variable\nPercent of county population residing in WUI\n\n\nLogLyme0103_1113\nDependent Variable\nLyme disease incidence\n\n\nMeanPatchArea\nExogenous Covariate\nAverage forest patch area by county\n\n\nEdgeDensity\nExogenous Covariate\nForest edge density by county\n\n\nPercLandForest\nExogenous Covariate\n% forested area in county\n\n\nStateYrGroup\nFixed Variable\nIdentifier for each observation based on state and year\n\n\nAgStatDistrict\nClustering Variable (for CMSE)\nUSDA agricultural statistics districts\n\n\n\n\n\nFirst and second stage IV regression\nA general overview of the methods employed in the paper…\nThe instrument is first regressed on the endogenous variable\n\nstage_1 &lt;- lm(PercWuiPop ~ DensityResIndex,\n              data = lyme_na)\n\nThen the first stage fitted values are regressed against the dependant variable.\n\nstage_2 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop, \n              data = lyme_na)\n\nBoth stages include covariates, although the strength of them will be tested later on.\n\nstage_1 &lt;- lm(PercWuiPop ~ DensityResIndex +\n              MeanPatchArea + EdgeDensity + PercLandForest, \n              data = lyme_na)\n\nstage_2 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop +\n              MeanPatchArea + EdgeDensity + PercLandForest, \n              data = lyme_na)\n\nThe ivreg package can run both the stage 1 and stage 2 regressions intertwined in a single function, making this process easy.\n\nlyme_iv &lt;- ivreg(LogLyme0103_1113 ~ MeanPatchArea + EdgeDensity + PercLandForest | # covariates\n                 PercWuiPop | # endogenous variable\n                 DensityResIndex, # instrumental variable\n  data = lyme_na)\n\nsummary(lyme_iv)\n\n\nCall:\nivreg(formula = LogLyme0103_1113 ~ MeanPatchArea + EdgeDensity + \n    PercLandForest | PercWuiPop | DensityResIndex, data = lyme_na)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.5836 -0.9984  0.1557  1.0503  3.3776 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)     1.789588   0.186272   9.607  &lt; 2e-16 ***\nPercWuiPop      0.037167   0.008414   4.417 1.22e-05 ***\nMeanPatchArea  -0.042153   0.017051  -2.472   0.0138 *  \nEdgeDensity    -0.002510   0.007850  -0.320   0.7493    \nPercLandForest  0.007982   0.018260   0.437   0.6622    \n\nDiagnostic tests:\n                 df1 df2 statistic  p-value    \nWeak instruments   1 509     62.97 1.35e-14 ***\nWu-Hausman         1 508     17.09 4.17e-05 ***\nSargan             0  NA        NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.459 on 509 degrees of freedom\nMultiple R-Squared: -0.005559,  Adjusted R-squared: -0.01346 \nWald test: 28.41 on 4 and 509 DF,  p-value: &lt; 2.2e-16 \n\n\n\n\nFixed effects\nThe authors also ran the second stage as a fixed effects model. This approach is one where you group your data to account for unobserved differences between them. It does this by using a dummy variable (0 or 1) for each class for a group to indicate which data are from which class.\nHere, the models were fixed by year or state & year.\n\nfixed_effects &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + as_factor(StateYrGroup) - 1, data = lyme_na)\n\nsummary(fixed_effects)\n\n\nCall:\nlm(formula = LogLyme0103_1113 ~ PercWuiPop + as_factor(StateYrGroup) - \n    1, data = lyme_na)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.2041 -0.6909 -0.0239  0.6520  4.9930 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \nPercWuiPop                0.017941   0.001989   9.022  &lt; 2e-16 ***\nas_factor(StateYrGroup)1  3.454231   0.420940   8.206 2.04e-15 ***\nas_factor(StateYrGroup)2  2.879821   0.421244   6.836 2.43e-11 ***\nas_factor(StateYrGroup)3  2.920626   0.648817   4.501 8.44e-06 ***\nas_factor(StateYrGroup)4  3.983158   0.648824   6.139 1.72e-09 ***\nas_factor(StateYrGroup)5  0.598705   0.340043   1.761   0.0789 .  \nas_factor(StateYrGroup)6  2.711908   0.342733   7.913 1.70e-14 ***\nas_factor(StateYrGroup)7  2.458755   0.328560   7.483 3.39e-13 ***\nas_factor(StateYrGroup)8  3.046376   0.328395   9.277  &lt; 2e-16 ***\nas_factor(StateYrGroup)9  2.471677   0.322881   7.655 1.04e-13 ***\nas_factor(StateYrGroup)10 3.369002   0.321252  10.487  &lt; 2e-16 ***\nas_factor(StateYrGroup)11 1.505099   0.178967   8.410 4.53e-16 ***\nas_factor(StateYrGroup)12 2.742846   0.179086  15.316  &lt; 2e-16 ***\nas_factor(StateYrGroup)13 0.968439   0.455144   2.128   0.0339 *  \nas_factor(StateYrGroup)14 3.004004   0.456960   6.574 1.26e-10 ***\nas_factor(StateYrGroup)15 2.364315   0.267596   8.835  &lt; 2e-16 ***\nas_factor(StateYrGroup)16 3.100802   0.266760  11.624  &lt; 2e-16 ***\nas_factor(StateYrGroup)17 0.980690   0.188115   5.213 2.74e-07 ***\nas_factor(StateYrGroup)18 2.117406   0.187057  11.320  &lt; 2e-16 ***\nas_factor(StateYrGroup)19 1.807620   0.198379   9.112  &lt; 2e-16 ***\nas_factor(StateYrGroup)20 2.624127   0.197436  13.291  &lt; 2e-16 ***\nas_factor(StateYrGroup)21 0.442376   0.381141   1.161   0.2463    \nas_factor(StateYrGroup)22 2.936382   0.383114   7.665 9.74e-14 ***\nas_factor(StateYrGroup)23 1.525581   0.185235   8.236 1.64e-15 ***\nas_factor(StateYrGroup)24 3.005449   0.185549  16.198  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.123 on 489 degrees of freedom\nMultiple R-squared:  0.8878,    Adjusted R-squared:  0.8821 \nF-statistic: 154.8 on 25 and 489 DF,  p-value: &lt; 2.2e-16\n\n\nThe paper states that the fixed-effects had very little to know effect on the estimate, only changing it by +-0.002.\n\n\nF-test and Robustness Checks\nIn the most general sense, a F-test looks for statistical significance by comparing variances. But in a modeling context, a F-test can be used to estimate how much the addition of 1 or more variables improves the model. We do this by comparing our restricted and unrestricted models.\nThe general equation:\n\\(F = \\frac{\\text{SSE}_R - \\text{SSE}_{UR} / e}{\\text{SSE}_{UR} / (n - k)}\\)\nWhere:\n\n\\(\\text{SSE}_{UR}\\) is the full model with every variable.\n\\(\\text{SSE}_{R}\\) is a model with one or more variables excluded. The excluded variables are being tested for their strength.\n\\(\\text e\\) is the restrictions or the total number of omitted variables\n\\(\\text k\\) is the total number of variables in the regression, including the intercept.\n\\(\\text n\\) is the sample size.\n\nThey performed this test on the first stage of the IV approach. To accomplish this manually in R…\n\n# get unrestricted model\nur_model &lt;- lm(PercWuiPop ~ DensityResIndex\n               + MeanPatchArea + EdgeDensity + PercLandForest \n              ,data = lyme_na)\n\n# sse unrestricted\nsse_ur &lt;- sum((fitted(ur_model) - lyme_na$PercWuiPop)^2)\n\n# restricted models\nr_model &lt;- lm(PercWuiPop ~ MeanPatchArea + EdgeDensity + PercLandForest \n              ,data = lyme_na)\n\n# sse restricted\nsse_r &lt;- sum((fitted(r_model) - lyme_na$PercWuiPop)^2)\n\n# non-robust f test\nF_std &lt;- ((sse_r - sse_ur) / 1) / \n           (sse_ur / (nrow(lyme_na) - 5))\n\ncat(\"F value: \", F_std, \"\\n\")\n\nF value:  62.96987 \n\n\nThis can also be accomplished with an ANOVA…\n\nf_stat &lt;- anova(r_model, ur_model)\ncat(\"F value with ANOVA: \", f_stat$F[2])\n\nF value with ANOVA:  62.96987\n\n\nA F-value above 10 indicates a strong instrument, and this F is significantly above 10.\nYou would then obtain a critical value.\n\n\\(\\text ResDF_{UR}\\) is derived from sample size of dataset - total num of variables in model\n\\(\\text ResDF_{R}\\) is derived from the previously calculated Residual Df, minus the number of restrictions.\n\\(\\text {Df}_1\\) is therefore derived from ResDF_UR - variables in model.\n\\(\\text {Df}_2\\) is k - \\(\\text {Df}_1\\) - 1\n\nWe will just use the qf() function to calculate it.\nWith a df2 this large, it would be approximately 2.20. But we can also calculate it with qf():\n\ndf1 &lt;- summary(ur_model)$coefficients %&gt;% nrow()\n\ncat(\"F distribution critical value: \", qf(0.95, f_stat$Df[2], df1 - f_stat$Df[2] - 1))\n\nF distribution critical value:  10.12796\n\n\nThe problem with doing the F-test this way, is that it’s not robust. It assumes homoscedasticity and i.i.d, which because the data has both a time and spatial component, likely isn’t true. To account for this, the paper also performs a more robust version of the F-test called the effective F, from Olea & Pflueger (2013). This test balances the instrumental variables and endogenous variables by a weighted covariance matrix. The matrix accounts for unequal variance and clustering. Although clustering was already accounted for as the error term for these models are clustered mean squared errors (CMSE).\n\\(F_{\\text{eff}} = \\frac{(Y'X) \\hat{W}^{-1}_2 (Z'X)}{K \\cdot n}\\)\n\\(\\text Z\\) is an instrumental variable vector. \\(\\text X\\) is an endogenous variable vector. \\(\\text Z', X'\\) are transposes of the prior variables (as in row to column, or vise versa) \\(\\hat{W}^{-1}_2\\) is the covariance matrix \\(\\text K\\) is number of instruments \\(\\text n\\) is sample size\nThe crux of effective F is the \\(\\tau\\) parameter. A higher tau means lower critical values and less strict criteria. For lower \\(\\tau\\)s, the opposite is true. A generally accepted \\(\\tau\\) is 10%.\nThis can be done simply with eff_F() from the ivDiag package:\n\neffective_f &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", controls = c(\"PercLandForest\", \"EdgeDensity\", \"MeanPatchArea\"), cl = \"AgStatDistrict\")\n\ncat(\"Effective F Stat:\", effective_f)\n\nEffective F Stat: 11.4094\n\n\n\n\nClustered Mean Squared Errors\nI had mentioned earlier in this blog that clustering should not be a problem when doing the non-robust F-test. This is because this study uses clustered mean squared errors (CMSE) as it’s error term. We can calculate them with vcovCL() from the sandwich package, and get a summary/hypothesis test with the coeftest() from the lmtest package.\nYou funnel in a model and a clustering variable within the dataset:\n\n# Calculate clustered standard errors\nclustered_se &lt;- vcovCL(ur_model, cluster = ~ AgStatDistrict)\n# Hypothesis testing with clustered standard errors\ncoeftest(ur_model, vcov = clustered_se)\n\n\nt test of coefficients:\n\n                Estimate Std. Error t value  Pr(&gt;|t|)    \n(Intercept)     -4.42576    3.44729 -1.2838 0.1997827    \nDensityResIndex 23.08206    6.83351  3.3778 0.0007867 ***\nMeanPatchArea   -0.14486    0.37884 -0.3824 0.7023420    \nEdgeDensity      0.35138    0.18181  1.9326 0.0538361 .  \nPercLandForest   0.80993    0.45888  1.7650 0.0781565 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "posts/macdonald_2018_breakdown/index.html#results",
    "href": "posts/macdonald_2018_breakdown/index.html#results",
    "title": "MacDonald et al. (2018) Breakdown",
    "section": "Results",
    "text": "Results\nThis study created a variety of different models and tested different combinations of covariates. The models used were:\n\nOLS\nYear Fixed Effects\nState * Year Fixed Effects\nIV\nIV with Year Fixed Effects\n\nAnd the different combinations of covariates were: * None (Bivariate model) * % Forest & Edge Density * % Forest & Mean Patch Size * Mean Patch Size & Edge Density * All covariates\nHere, we run all models…\n\n\nCode\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                                    OLS                                   ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Bivariate models                              ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nols_biv &lt;- lm(LogLyme0103_1113 ~ PercWuiPop, data = lyme)\nols_biv_clust &lt;- ols_biv %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(ols_biv, vcov = .)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Multivariate models                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# %forest + edge\nols_multi_1 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + EdgeDensity + PercLandForest, data = lyme)\nols_multi_1_clust &lt;- ols_multi_1 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(ols_multi_1, vcov = .)\n\n# %Forest + patch area\nols_multi_2 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + PercLandForest, data = lyme)\nols_multi_2_clust &lt;- ols_multi_2 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(ols_multi_2, vcov = .)\n\n# mean patch + edge\nols_multi_3 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity, data = lyme)\nols_multi_3_clust &lt;- ols_multi_3 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(ols_multi_3, vcov = .)\n\n# %Forest + mean patch + edge\nols_multi_4 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity + PercLandForest, data = lyme)\nols_multi_4_clust &lt;- ols_multi_4 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(ols_multi_4, vcov = .)\n\n     #                Combine all models into list                 ~~~\n     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\nols_models &lt;- list(ols_biv = ols_biv_clust[2,1:2], \n                ols_multi_1 = ols_multi_1_clust[2:nrow(ols_multi_1_clust),1:2], \n                ols_multi_2 = ols_multi_2_clust[2:nrow(ols_multi_2_clust),1:2], \n                ols_multi_3 = ols_multi_3_clust[2:nrow(ols_multi_3_clust),1:2], \n                ols_multi_4 = ols_multi_4_clust[2:nrow(ols_multi_4_clust),1:2])\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                                  YEAR FE                                 ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Bivariate models                              ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nyearfe_biv &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + as_factor(Year) - 1, data = lyme)\nyearfe_biv_clust &lt;- yearfe_biv %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(yearfe_biv, vcov = .)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Multivariate models                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# %forest + edge\nyearfe_multi_1 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + EdgeDensity + PercLandForest + as_factor(Year) - 1, data = lyme)\nyearfe_multi_1_clust &lt;- yearfe_multi_1 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(yearfe_multi_1, vcov = .)\n\n# %Forest + patch area\nyearfe_multi_2 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + PercLandForest + as_factor(Year) - 1, data = lyme)\nyearfe_multi_2_clust &lt;- yearfe_multi_2 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(yearfe_multi_2, vcov = .)\n\n# mean patch + edge\nyearfe_multi_3 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity + as_factor(Year) - 1, data = lyme)\nyearfe_multi_3_clust &lt;- yearfe_multi_3 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(yearfe_multi_3, vcov = .)\n\n# %Forest + mean patch + edge\nyearfe_multi_4 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity + PercLandForest + as_factor(Year) - 1, data = lyme)\nyearfe_multi_4_clust &lt;- yearfe_multi_4 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(yearfe_multi_4, vcov = .)\n\n     #                Combine all models into list                 ~~~\n     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\nyear_fe_models &lt;- list(yearfe_biv = yearfe_biv_clust[1, c(\"Estimate\", \"Std. Error\")], \n                yearfe_multi_1 = yearfe_multi_1_clust[1:3, c(\"Estimate\", \"Std. Error\")], \n                yearfe_multi_2 = yearfe_multi_2_clust[1:3, c(\"Estimate\", \"Std. Error\")], \n                yearfe_multi_3 = yearfe_multi_3_clust[1:3, c(\"Estimate\", \"Std. Error\")], \n                yearfe_multi_4 = yearfe_multi_4_clust[1:4, c(\"Estimate\", \"Std. Error\")])\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                              STATE + YEAR FE                             ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Bivariate models                              ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nstateyearfe_biv &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + as_factor(StateYrGroup) - 1, data = lyme)\nstateyearfe_biv_clust &lt;- stateyearfe_biv %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(stateyearfe_biv, vcov = .)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Multivariate models                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# %forest + edge\nstateyearfe_multi_1 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + EdgeDensity + PercLandForest + as_factor(StateYrGroup) - 1, data = lyme)\nstateyearfe_multi_1_clust &lt;- stateyearfe_multi_1 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(stateyearfe_multi_1, vcov = .)\n\n# %Forest + patch area\nstateyearfe_multi_2 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + PercLandForest + as_factor(StateYrGroup) - 1, data = lyme)\nstateyearfe_multi_2_clust &lt;- stateyearfe_multi_2 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(stateyearfe_multi_2, vcov = .)\n\n# mean patch + edge\nstateyearfe_multi_3 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity + as_factor(StateYrGroup) - 1, data = lyme)\nstateyearfe_multi_3_clust &lt;- stateyearfe_multi_3 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(stateyearfe_multi_3, vcov = .)\n\n# %Forest + mean patch + edge\nstateyearfe_multi_4 &lt;- lm(LogLyme0103_1113 ~ PercWuiPop + MeanPatchArea + EdgeDensity + PercLandForest + as_factor(StateYrGroup) - 1, data = lyme)\nstateyearfe_multi_4_clust &lt;- stateyearfe_multi_4 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(stateyearfe_multi_4, vcov = .)\n\n     #                Combine all models into list                 ~~~\n     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\nstateyearfe_models &lt;- list(stateyearfe_biv = stateyearfe_biv_clust[1, c(\"Estimate\", \"Std. Error\")], \n                stateyearfe_multi_1 = stateyearfe_multi_1_clust[1:3, 1:2], \n                stateyearfe_multi_2 = stateyearfe_multi_2_clust[1:3, 1:2], \n                stateyearfe_multi_3 = stateyearfe_multi_3_clust[1:3, 1:2], \n                stateyearfe_multi_4 = stateyearfe_multi_4_clust[1:4, 1:2])\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                                     IV                                   ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Bivariate models                              ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\niv_biv &lt;- ivreg(LogLyme0103_1113 ~ PercWuiPop |\n  DensityResIndex,\n  data = lyme_na)\niv_biv_clust &lt;- iv_biv %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_biv, vcov = .)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Multivariate models                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# %forest + edge\niv_multi_1 &lt;- ivreg(LogLyme0103_1113 ~ EdgeDensity + PercLandForest | \n                        PercWuiPop | \n                        DensityResIndex, \n                    data = lyme_na)\niv_multi_1_clust &lt;- iv_multi_1 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_multi_1, vcov = .)\n\n# %Forest + patch area\niv_multi_2 &lt;- ivreg(LogLyme0103_1113 ~ MeanPatchArea + PercLandForest | \n                        PercWuiPop | \n                        DensityResIndex, \n                    data = lyme_na)\niv_multi_2_clust &lt;- iv_multi_2 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_multi_2, vcov = .)\n\n# mean patch + edge\niv_multi_3 &lt;- ivreg(LogLyme0103_1113 ~ MeanPatchArea + EdgeDensity | \n                        PercWuiPop | \n                        DensityResIndex, \n                    data = lyme_na)\niv_multi_3_clust &lt;- iv_multi_3 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_multi_3, vcov = .)\n\n# %Forest + mean patch + edge\niv_multi_4 &lt;- ivreg(LogLyme0103_1113 ~ MeanPatchArea + EdgeDensity + PercLandForest | \n                        PercWuiPop | \n                        DensityResIndex, \n                    data = lyme_na)\niv_multi_4_clust &lt;- iv_multi_4 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_multi_4, vcov = .)\n\n     #                Combine all models into list                 ~~~\n     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\niv_models &lt;- list(iv_biv = iv_biv_clust[1, c(\"Estimate\", \"Std. Error\")], \n                iv_multi_1 = iv_multi_1_clust[2:4, 1:2], \n                iv_multi_2 = iv_multi_2_clust[2:4, 1:2], \n                iv_multi_3 = iv_multi_3_clust[2:4, 1:2], \n                iv_multi_4 = iv_multi_4_clust[2:5, 1:2])\n\n\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                                IV + YEAR FE                              ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Bivariate models                              ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\niv_yearfe_biv &lt;- ivreg(LogLyme0103_1113 ~ PercWuiPop  + as_factor(Year) - 1 | \n                           DensityResIndex + as_factor(Year) - 1, \n                       data = lyme_na\n  )\niv_yearfe_biv_clust &lt;- iv_yearfe_biv %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;%\n    coeftest(iv_yearfe_biv, vcov = .)\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                            Multivariate models                           ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n# %forest + edge\niv_yearfe_multi_1 &lt;- ivreg(\n    LogLyme0103_1113 ~ PercWuiPop + PercLandForest + EdgeDensity + as_factor(Year) - 1 | \n                       DensityResIndex + PercLandForest + EdgeDensity + as_factor(Year) - 1, \n                       data = lyme_na\n  )\niv_yearfe_multi_1_clust &lt;- iv_yearfe_multi_1 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_yearfe_multi_1, vcov = .)\n\n# %Forest + patch area\niv_yearfe_multi_2 &lt;- ivreg(\n    LogLyme0103_1113 ~ PercWuiPop + PercLandForest + MeanPatchArea + as_factor(Year) - 1 | \n                       DensityResIndex + PercLandForest + MeanPatchArea + as_factor(Year) - 1, \n                       data = lyme_na\n  )\niv_yearfe_multi_2_clust &lt;- iv_yearfe_multi_2 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_yearfe_multi_2, vcov = .)\n\n# mean patch + edge\niv_yearfe_multi_3 &lt;- ivreg(\n    LogLyme0103_1113 ~ PercWuiPop + EdgeDensity + MeanPatchArea + as_factor(Year) - 1 | \n                       DensityResIndex + EdgeDensity + MeanPatchArea + as_factor(Year) - 1 , \n                       data = lyme_na\n  )\niv_yearfe_multi_3_clust &lt;- iv_yearfe_multi_3 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_yearfe_multi_3, vcov = .)\n\n# %Forest + mean patch + edge\niv_yearfe_multi_4 &lt;- ivreg(\n    LogLyme0103_1113 ~ PercWuiPop + PercLandForest + EdgeDensity + MeanPatchArea + as_factor(Year) - 1| \n                       DensityResIndex + PercLandForest + EdgeDensity + MeanPatchArea + as_factor(Year) - 1, \n                       data = lyme_na\n  )\niv_yearfe_multi_4_clust &lt;- iv_yearfe_multi_4 %&gt;% \n    vcovCL(cluster = ~ AgStatDistrict) %&gt;% \n    coeftest(iv_yearfe_multi_4, vcov = .)\n\n     #                Combine all models into list                 ~~~\n     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\niv_yearfe_models &lt;- list(iv_yearfe_biv = iv_yearfe_biv_clust[1, c(\"Estimate\", \"Std. Error\")], \n                iv_yearfe_multi_1 = iv_yearfe_multi_1_clust[1:3, 1:2], \n                iv_yearfe_multi_2 = iv_yearfe_multi_2_clust[1:3, 1:2], \n                iv_yearfe_multi_3 = iv_yearfe_multi_3_clust[1:3, 1:2], \n                iv_yearfe_multi_4 = iv_yearfe_multi_4_clust[1:4, 1:2])\n\n\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##                                                                            ~~\n##                          FUNCTION TO CREATE MODELS                       ----\n##                                                                            ~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n\n\n\n\nmake_table &lt;- function(models, type_label){\n\n    table_output = data_frame()\n    \n    for(i in 1:length(models)){\n        \n        if(length(models[[i]]) &lt; 3){\n            \n            table_output &lt;- table_output %&gt;% \n                bind_rows(models[[i]]) %&gt;% \n              mutate(model = type_label, \n                     type = \"bivariate\",\n                     covariate = \"PercWuiPop\",\n                     num = 0)\n        }\n        else{\n            table_output &lt;- table_output %&gt;% \n                 bind_rows(\n            models[[i]] %&gt;% as_tibble()\n         %&gt;%\n              mutate(model = type_label,\n                     type = \"multivariate\",\n                     covariate = names(models[[i]][,1]),\n                     num = i - 1\n                     )\n                 )\n        }\n    }\n    \n    return(table_output)\n\n}\n\n\n\n\nols_table &lt;- make_table(ols_models, \"OLS\") %&gt;% \n    select(-model) %&gt;% \n    rename(Std_Error = \"Std. Error\") %&gt;%\n    mutate(Estimate = Estimate %&gt;% signif(2), \n           Std_Error = Std_Error %&gt;% signif(2))\n\nyear_fe_table &lt;- make_table(year_fe_models, \"Year FE\") %&gt;% \n    select(-model) %&gt;% \n    rename(Std_Error = \"Std. Error\") %&gt;%\n    mutate(Estimate = Estimate %&gt;% signif(2), \n           Std_Error = Std_Error %&gt;% signif(2))\n\nstateyearfe_table &lt;- make_table(stateyearfe_models, \"State + Year FE\") %&gt;% \n    select(-model) %&gt;% \n    rename(Std_Error = \"Std. Error\") %&gt;%\n    mutate(Estimate = Estimate %&gt;% signif(2), \n           Std_Error = Std_Error %&gt;% signif(2))\n\niv_table &lt;- make_table(iv_models, \"IV\") %&gt;% \n    select(-model) %&gt;% \n    rename(Std_Error = \"Std. Error\") %&gt;%\n    mutate(Estimate = Estimate %&gt;% signif(2), \n           Std_Error = Std_Error %&gt;% signif(2))\n\niv_yearfe_table &lt;- make_table(iv_yearfe_models, \"IV + Year FE\") %&gt;% \n    select(-model) %&gt;% \n    rename(Std_Error = \"Std. Error\") %&gt;%\n    mutate(Estimate = Estimate %&gt;% signif(2), \n           Std_Error = Std_Error %&gt;% signif(2))\n\n\n\nTable creation for every model\n\n\n# A tibble: 14 × 5\n   Estimate Std_Error type         covariate        num\n      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;\n 1   0.017     0.0034 bivariate    PercWuiPop         0\n 2   0.0051    0.0038 multivariate PercWuiPop         1\n 3   0.03      0.0061 multivariate EdgeDensity        1\n 4  -0.013     0.009  multivariate PercLandForest     1\n 5   0.0066    0.0037 multivariate PercWuiPop         2\n 6  -0.059     0.013  multivariate MeanPatchArea      2\n 7   0.057     0.012  multivariate PercLandForest     2\n 8   0.0052    0.0037 multivariate PercWuiPop         3\n 9  -0.014     0.0077 multivariate MeanPatchArea      3\n10   0.026     0.0048 multivariate EdgeDensity        3\n11   0.005     0.0038 multivariate PercWuiPop         4\n12  -0.022     0.02   multivariate MeanPatchArea      4\n13   0.023     0.0094 multivariate EdgeDensity        4\n14   0.0095    0.023  multivariate PercLandForest     4\n\n\n# A tibble: 14 × 5\n   Estimate Std_Error type         covariate        num\n      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;\n 1   0.016     0.0035 bivariate    PercWuiPop         0\n 2   0.0046    0.0038 multivariate PercWuiPop         1\n 3   0.03      0.0061 multivariate EdgeDensity        1\n 4  -0.012     0.0091 multivariate PercLandForest     1\n 5   0.0061    0.0038 multivariate PercWuiPop         2\n 6  -0.06      0.013  multivariate MeanPatchArea      2\n 7   0.058     0.012  multivariate PercLandForest     2\n 8   0.0047    0.0038 multivariate PercWuiPop         3\n 9  -0.014     0.0078 multivariate MeanPatchArea      3\n10   0.027     0.0049 multivariate EdgeDensity        3\n11   0.0045    0.0038 multivariate PercWuiPop         4\n12  -0.022     0.019  multivariate MeanPatchArea      4\n13   0.023     0.0095 multivariate EdgeDensity        4\n14   0.01      0.022  multivariate PercLandForest     4\n\n\n# A tibble: 14 × 5\n   Estimate Std_Error type         covariate        num\n      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;\n 1   0.018     0.0038 bivariate    PercWuiPop         0\n 2   0.0057    0.0038 multivariate PercWuiPop         1\n 3   0.029     0.0057 multivariate EdgeDensity        1\n 4  -0.0069    0.011  multivariate PercLandForest     1\n 5   0.0066    0.0038 multivariate PercWuiPop         2\n 6  -0.061     0.013  multivariate MeanPatchArea      2\n 7   0.064     0.014  multivariate PercLandForest     2\n 8   0.0064    0.0039 multivariate PercWuiPop         3\n 9  -0.011     0.0089 multivariate MeanPatchArea      3\n10   0.027     0.0049 multivariate EdgeDensity        3\n11   0.0055    0.0038 multivariate PercWuiPop         4\n12  -0.028     0.019  multivariate MeanPatchArea      4\n13   0.02      0.0086 multivariate EdgeDensity        4\n14   0.021     0.023  multivariate PercLandForest     4\n\n\n# A tibble: 14 × 5\n   Estimate Std_Error type         covariate        num\n      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;\n 1  1.4        0.4    bivariate    PercWuiPop         0\n 2  0.038      0.014  multivariate PercWuiPop         1\n 3  0.0093     0.0089 multivariate EdgeDensity        1\n 4 -0.031      0.014  multivariate PercLandForest     1\n 5  0.037      0.013  multivariate PercWuiPop         2\n 6 -0.038      0.019  multivariate MeanPatchArea      2\n 7  0.0031     0.026  multivariate PercLandForest     2\n 8  0.037      0.014  multivariate PercWuiPop         3\n 9 -0.035      0.012  multivariate MeanPatchArea      3\n10  0.00038    0.011  multivariate EdgeDensity        3\n11  0.037      0.014  multivariate PercWuiPop         4\n12 -0.042      0.022  multivariate MeanPatchArea      4\n13 -0.0025     0.011  multivariate EdgeDensity        4\n14  0.008      0.027  multivariate PercLandForest     4\n\n\n# A tibble: 14 × 5\n   Estimate Std_Error type         covariate        num\n      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;dbl&gt;\n 1   0.037     0.0087 bivariate    PercWuiPop         0\n 2   0.038     0.014  multivariate PercWuiPop         1\n 3  -0.031     0.014  multivariate PercLandForest     1\n 4   0.0095    0.0089 multivariate EdgeDensity        1\n 5   0.037     0.013  multivariate PercWuiPop         2\n 6   0.0038    0.026  multivariate PercLandForest     2\n 7  -0.038     0.019  multivariate MeanPatchArea      2\n 8   0.037     0.014  multivariate PercWuiPop         3\n 9   0.0007    0.011  multivariate EdgeDensity        3\n10  -0.035     0.012  multivariate MeanPatchArea      3\n11   0.037     0.014  multivariate PercWuiPop         4\n12   0.0084    0.027  multivariate PercLandForest     4\n13  -0.0023    0.011  multivariate EdgeDensity        4\n14  -0.042     0.022  multivariate MeanPatchArea      4\n\n\nThese tables contain all estimates and errors for every tested model.\nA series of robust checks were also performed on the first stage for 5 different models containing the different combinations of covariates specified previously. These tests are the non-robust F test, the Effective F test, and the Specification test. Although here I will just perform the Effective F Weak Instruments Test.\n\n\nCode\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##  ~ Model 1: No Covariates  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nno_covariates &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", cl = \"AgStatDistrict\", FE = \"as_factor(Year)\")\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##  ~ Model 2: % Forest + Edge Density  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nforest_edge &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", controls = c(\"PercLandForest\", \"EdgeDensity\"), cl = \"AgStatDistrict\")\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##  ~ Model 3: % Forest + Mean Patch Area  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nforest_patch &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", controls = c(\"PercLandForest\", \"MeanPatchArea\"), cl = \"AgStatDistrict\")\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##  ~ Model 4: Edge Density + Mean Patch Area  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nedge_patch &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", controls = c(\"EdgeDensity\", \"MeanPatchArea\"), cl = \"AgStatDistrict\")\n\n\n\n\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n##  ~ Model 5: All Covariates  ----\n##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nall_covariates &lt;- eff_F(lyme_na, Y = \"LogLyme0103_1113\", D = \"PercWuiPop\", Z = \"DensityResIndex\", controls = c(\"PercLandForest\", \"EdgeDensity\", \"MeanPatchArea\"), cl = \"AgStatDistrict\")\n\n\n\n\n#....................Printing the F statistics...................\ncat(\" No covariates effective F stat: \", no_covariates, \"**\", \"\\n\", \n    \"% forest + edge density effective F stat: \", forest_edge, \"\\n\", \n    \"% forest + Mean Patch Area effective F stat: \", forest_patch, \"\\n\", \n    \"Edge density + mean match area effective F stat: \", edge_patch, \"\\n\", \n    \"All covariates effective F stat: \", all_covariates, \"\\n\"\n    )\n\n\n No covariates effective F stat:  23.6541 ** \n % forest + edge density effective F stat:  11.9416 \n % forest + Mean Patch Area effective F stat:  10.5339 \n Edge density + mean match area effective F stat:  12.8009 \n All covariates effective F stat:  11.4094 \n\n\nThe only model that is significant to \\(\\alpha &lt; 0.05\\) is the no covariates model. The other models would be significant if we accept \\(\\tau &lt; 0.30\\), but that is very low precision.\nThe other robustness tests were not performed because I could not replicate their values, likely due to my own error. This being said, we can still check the F statistic of each of the models, as it is build into summary().\n\n\nCode\nno_covariates_f &lt;- lm(PercWuiPop ~ DensityResIndex + # instrumental variable\n       as_factor(Year), # fixed effects\n  data = lyme_na) %&gt;% \n    summary()\n\nforest_edge_f &lt;- lm(PercWuiPop ~ DensityResIndex + # instrumental variable\n       MeanPatchArea + EdgeDensity + # covariates\n       as_factor(Year), # fixed effects\n  data = lyme_na) %&gt;% \n    summary()\n\nforest_patch_f &lt;- lm(PercWuiPop ~ DensityResIndex + # instrumental variable\n       MeanPatchArea + PercLandForest + # covariates\n       as_factor(Year), # fixed effects\n  data = lyme_na) %&gt;% \n    summary()\n\nedge_patch_f &lt;- lm(PercWuiPop ~ DensityResIndex + # instrumental variable\n       MeanPatchArea + EdgeDensity + # covariates\n       as_factor(Year), # fixed effects\n  data = lyme_na) %&gt;% \n    summary()\n\n\nall_covariates_f &lt;- lm(PercWuiPop ~ DensityResIndex + # instrumental variable\n       MeanPatchArea + EdgeDensity + PercLandForest + # covariates\n       as_factor(Year), # fixed effects\n  data = lyme_na) %&gt;% \n    summary()\n\n\ncat(\" No covariates non-robust F stat: \", no_covariates_f$fstatistic[1], \"**\", \"\\n\", \n    \"% forest + edge density non-robust F stat: \", forest_edge_f$fstatistic[1], \"\\n\", \n    \"% forest + Mean Patch Area non-robust F stat: \", forest_patch_f$fstatistic[1], \"\\n\", \n    \"Edge density + mean match area non-robust F stat: \", edge_patch_f$fstatistic[1], \"\\n\", \n    \"All covariates non-robust F stat: \", all_covariates_f$fstatistic[1]\n    )\n\n\n No covariates non-robust F stat:  37.18896 ** \n % forest + edge density non-robust F stat:  141.0745 \n % forest + Mean Patch Area non-robust F stat:  140.3725 \n Edge density + mean match area non-robust F stat:  141.0745 \n All covariates non-robust F stat:  116.9124\n\n\nThese F statistics are likely very overinflated, but are significantly above 10."
  },
  {
    "objectID": "posts/macdonald_2018_breakdown/index.html#conclusion",
    "href": "posts/macdonald_2018_breakdown/index.html#conclusion",
    "title": "MacDonald et al. (2018) Breakdown",
    "section": "Conclusion",
    "text": "Conclusion\nThe study seems pretty rock solid in terms of validating the assumptions of the model, as CMSE accounts for clustering and biases, the effective F accounts for potential heteroscedasticity, and the fixed effects account for any autocorrelation issues (even though it didn’t have much of an effect). Furthermore, the IV approach potentially mitigated any endogeneity bias.\nThe only mark against the study is that the effective F was not significant when adding the covariates at a \\(\\tau\\) of 10%. It was significant without them, but omitting them could lead of omitted variable bias.\nThis study possibly suggests that lot size regulations are a good instrument to measure Lyme incidence. At the very least, it suggests that this methodology could be more effective than previously used ones, as the endogeneity bias makes directly using habitat fragmentation as a predictor unreliable."
  }
]