<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joshua Paul Cohen">
<meta name="dcterms.date" content="2024-12-19">
<meta name="description" content="A data analysis of the effect of California’s pesticide use on Anthophila richness.">

<title>Pesticides and Bee Biodiversity at the Golden Coast – Joshua Paul Cohen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/my-favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="bib.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../website_icon_cropped.PNG" alt="cute silk moth" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Resume</span>
    </span>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Pesticides and Bee Biodiversity at the Golden Coast</h1>
                  <div>
        <div class="description">
          A data analysis of the effect of California’s pesticide use on Anthophila richness.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Bees</div>
                <div class="quarto-category">Pesticides</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Geospatial</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-page-left">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://silkiemoth.github.io/">Joshua Paul Cohen</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              MEDS
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-page-left">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 19, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#key-highlights" id="toc-key-highlights" class="nav-link" data-scroll-target="#key-highlights">Key Highlights</a></li>
  <li><a href="#repository-link" id="toc-repository-link" class="nav-link" data-scroll-target="#repository-link">Repository Link</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#big-bee-extending-anthophila-research-through-image-and-trait-digitization" id="toc-big-bee-extending-anthophila-research-through-image-and-trait-digitization" class="nav-link" data-scroll-target="#big-bee-extending-anthophila-research-through-image-and-trait-digitization">Big Bee: Extending Anthophila Research Through Image and Trait Digitization</a></li>
  <li><a href="#california-dpr-annual-pesticide-summaries" id="toc-california-dpr-annual-pesticide-summaries" class="nav-link" data-scroll-target="#california-dpr-annual-pesticide-summaries">California DPR Annual Pesticide Summaries</a></li>
  <li><a href="#california-public-land-survey-system" id="toc-california-public-land-survey-system" class="nav-link" data-scroll-target="#california-public-land-survey-system">California Public Land Survey System</a></li>
  <li><a href="#usgs-2023-land-cover-conus" id="toc-usgs-2023-land-cover-conus" class="nav-link" data-scroll-target="#usgs-2023-land-cover-conus">USGS 2023 Land Cover (CONUS)</a></li>
  </ul></li>
  <li><a href="#analysis-plan" id="toc-analysis-plan" class="nav-link" data-scroll-target="#analysis-plan">Analysis Plan</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul class="collapse">
  <li><a href="#final-figure" id="toc-final-figure" class="nav-link" data-scroll-target="#final-figure">Final Figure</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a>
  <ul class="collapse">
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">Reflection</a></li>
  <li><a href="#possible-next-steps" id="toc-possible-next-steps" class="nav-link" data-scroll-target="#possible-next-steps">Possible Next Steps</a></li>
  </ul></li>
  <li><a href="#citations" id="toc-citations" class="nav-link" data-scroll-target="#citations">Citations</a>
  <ul class="collapse">
  <li><a href="#in-text" id="toc-in-text" class="nav-link" data-scroll-target="#in-text">In Text</a></li>
  <li><a href="#data-1" id="toc-data-1" class="nav-link" data-scroll-target="#data-1">Data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Bees and other pollinators are extremely valuable for the ecosystem services they provide. Yet, throughout the past few decades, they have declined in both population and biodiversity (Goulson et al, 2015). Attributed factors are invasive parasites (Meeus et al, 2011), climate change (Soroye, Newbold, &amp; Kerr, 2020), habitat destruction (and fragmentation (Aizen &amp; Feinsinger, 1994), and pesticide use (Arena &amp; Sgolastra, 2014).</p>
<p>Several factor’s make California an ideal microcosm to analyze the effect of pesticides on bee biodiversity.</p>
<ul>
<li>The state’s 1989 Food Safety Act requires uniquely high standards for reporting (California DPR, 2023). Pesticide use datasets out of CA are therefore large and highly detailed.</li>
<li>CA is size means it has many different ecosystems contained within the same political boundaries.</li>
<li>CA is a agricultural hotspot in the country, meaning there are areas of intensive pesticide use.</li>
</ul>
<p>Therefore in this analysis, we will be analyzing pesticide use. Later, we introduce another variable, land cover, to see if there is a significant effect.</p>
<img src="figs/bee_pesticide_map.png" title="Bee Pesticide Map" class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
Pesticide use map by county, with bee species points overlaid. Most points are concentrated within Bay Area, Los Angeles, and San Diego.
</figcaption>
<section id="key-highlights" class="level2">
<h2 class="anchored" data-anchor-id="key-highlights">Key Highlights</h2>
<ul>
<li>Creation of two error models
<ul>
<li>A two variable model between biodiversity and pesticide use.</li>
<li>An extrapolation of the previous model with an added predictor of land cover.</li>
</ul></li>
<li>Diagnosing spatial autocorrelation in our models by running a lag model on the residuals and finding Moran’s I.</li>
<li>A hypothesis test for the affect of land cover on the model where we rejected the null.</li>
</ul>
</section>
<section id="repository-link" class="level2">
<h2 class="anchored" data-anchor-id="repository-link">Repository Link</h2>
<p>All code for this project <a href="https://github.com/silkieMoth/eds-222-final-project">can be accessed here</a>.</p>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="big-bee-extending-anthophila-research-through-image-and-trait-digitization" class="level3">
<h3 class="anchored" data-anchor-id="big-bee-extending-anthophila-research-through-image-and-trait-digitization">Big Bee: Extending Anthophila Research Through Image and Trait Digitization</h3>
<ul>
<li>Description
<ul>
<li>A large data base containing 4 million+ records of bee occurrence data for 5000+ unique species, along with attribute data.</li>
<li>Compilation of multiple databases.</li>
<li>Format: csv with latitude/longitude columns.</li>
<li>Contains observations from around the world, and from as early as the 19th century.</li>
<li>Led by Katja Seltmann, a researcher associated with the Cheadle Center for Biodiversity and Restoration at UCSB.</li>
<li>Overarching goal is to compile bee attribute data (body length, flight range, etc) for as many species as possible into one place.</li>
</ul></li>
<li>Limitations
<ul>
<li>Spatially biased: most observations are located near areas of high population</li>
<li>Dirty data: A compilation approach to sampling leads to inconsistent data structure with many NAs.</li>
<li>No absence data.</li>
<li>Includes citizen science data, increasing chance of possible misidentification.</li>
</ul></li>
<li>Subset in this analysis
<ul>
<li>Data from the past 5 years in all of California.</li>
</ul></li>
<li>Access
<ul>
<li>Data is downloadable from <a href="https://library.big-bee.net/portal/collections/map/index.php">the map section of the Big Bee Library</a>.</li>
<li>Must choose a subset to download, can subset by location, taxa, time, observer/collector, and more.</li>
</ul></li>
</ul>
</section>
<section id="california-dpr-annual-pesticide-summaries" class="level3">
<h3 class="anchored" data-anchor-id="california-dpr-annual-pesticide-summaries">California DPR Annual Pesticide Summaries</h3>
<ul>
<li>Description
<ul>
<li>In accordance with the Food Safety Act of 1989.</li>
<li>Contains data for products, active ingredients, amounts, locations, etc.</li>
<li>Format: comma delineated .txt files.</li>
</ul></li>
<li>Limitations
<ul>
<li>Does not contain spatial information, only analyzable spatially through joining.</li>
</ul></li>
<li>Subset in this analysis
<ul>
<li>All available data from 2017.</li>
</ul></li>
<li>Access Data is downloadable from <a href="https://www.cdpr.ca.gov/docs/pur/purmain.htm">California DPR’s Pesticide Use Reporting page</a>.</li>
</ul>
</section>
<section id="california-public-land-survey-system" class="level3">
<h3 class="anchored" data-anchor-id="california-public-land-survey-system">California Public Land Survey System</h3>
<ul>
<li>Description
<ul>
<li>Shapefile associated with the pesticide use data</li>
<li>Contains polygons for all CA townships.</li>
</ul></li>
<li>Limitations
<ul>
<li>Pesticide data does not contains a joinable column for township, only joinable by county.</li>
</ul></li>
<li>Access
<ul>
<li>See pesticide use data.</li>
</ul></li>
</ul>
</section>
<section id="usgs-2023-land-cover-conus" class="level3">
<h3 class="anchored" data-anchor-id="usgs-2023-land-cover-conus">USGS 2023 Land Cover (CONUS)</h3>
<ul>
<li>Description
<ul>
<li>Land cover classification types.</li>
<li>16 different classification types for water, development, forest/grassland, marsh, barren land, and agriculture.</li>
<li>CONUS stands for Conterminous United States.</li>
</ul></li>
<li>Limitations
<ul>
<li>Extremely large, and designed for a county wide scale. Needed to be aggregated to be worked with on a state wide scale</li>
<li>Aggregation caused distortion in classification values.</li>
</ul></li>
<li>Access
<ul>
<li>Data is downloadable from <a href="https://www.usgs.gov/centers/eros/science/data-access">it’s page on the official USGS website</a>.</li>
<li>It is possible to subset the data by uploading a county shapefile <a href="https://www.mrlc.gov/viewer/">in the MRLC Viewer</a>, then download each county individually, but this was not done due to time restrictions.</li>
</ul></li>
</ul>
<img src="figs/solano_land_cover.png" title="Solano County land type distribution." class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
A demonstration of a small subset of the data within the USGS Land Cover Dataset. Cropland and grassland are common land types in Solano County, with development also being notable.
</figcaption>
<p><br></p>
</section>
</section>
<section id="analysis-plan" class="level1">
<h1>Analysis Plan</h1>
<ol type="1">
<li>Initial data processing.</li>
<li>Define and create linear model.</li>
<li>Diagnose spatial autocorrelation, and create error model if evidence for autocorrelation is found.</li>
<li>Test for other correlating variables if initial model is not significant.</li>
<li>Create a new parallel slopes model with new variable.</li>
<li>Repeat steps 2 and 3 with new model.</li>
<li>Fitting a loess model.</li>
<li>Running a hypothesis test.</li>
</ol>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<section id="join-data" class="level4">
<h4 class="anchored" data-anchor-id="join-data">1. Join data</h4>
<ul>
<li>The pesticide data was summarized by county.</li>
<li>Bee occurence data was subsetted to just reccords ID’d down to species.</li>
<li>Pesticide data and CA County shapefile is joinable by <code>county_cd</code> (county code).
<ul>
<li>The shapefile contains polygons for every township district in the state, but there is no column in the pesticide data to join on that scale, so we must aggregate up to county.</li>
</ul></li>
<li>Shapefile and bee occurrence data are joinable by spatial relationship.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group by county and join population</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> townships <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county_cd) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pop_mean, <span class="at">by =</span> <span class="fu">join_by</span>(<span class="st">'county_cd'</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get pesticide sum by county</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>pesticides_sum <span class="ot">&lt;-</span> pesticides <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lbs_prd_used, county_cd) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county_cd) <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbs_prd_used =</span> <span class="fu">sum</span>(lbs_prd_used, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># join by county</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pest_by_county <span class="ot">&lt;-</span> <span class="fu">left_join</span>(counties, pesticides_sum, <span class="at">by =</span> <span class="fu">join_by</span>(county_cd))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># select for rows with ids down to species</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>bee_species <span class="ot">&lt;-</span> bees <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(taxonRank <span class="sc">==</span> <span class="st">'Species'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'id'</span>, <span class="st">'scientificName'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get species richness, by county</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>biodiversity <span class="ot">&lt;-</span> <span class="fu">st_join</span>(pest_by_county, bee_species) <span class="sc">%&gt;%</span> </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county_name) <span class="sc">%&gt;%</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbs_prd_used =</span> <span class="fu">first</span>(lbs_prd_used), </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">sp_richness =</span> <span class="fu">n_distinct</span>(scientificName)<span class="sc">/</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="define-linear-model" class="level4">
<h4 class="anchored" data-anchor-id="define-linear-model">2. Define linear model</h4>
<p>Initially, I tested if a linear model was appropriate. It is written as:</p>
<p><span class="math display">\[\text{Species Richness} = {\beta}_0 + {\beta}_1\text{Pesticide Amount}\]</span> I then created it in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>biodiv_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<img src="initial_lm.png" title="Initial linear model between biodiversity and pesticide use." class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
Species richness and pesticide use are not coorelated upon initial inspection, as the R<sup>2</sup> is very low and p-value is above 0.10.
</figcaption>
</section>
<section id="diagnose-spatial-autocorrelation." class="level4">
<h4 class="anchored" data-anchor-id="diagnose-spatial-autocorrelation.">3. Diagnose spatial autocorrelation.</h4>
<p>Spatial data often violates the homoscedasticity assumption of Only Least Squares (OLS), skewing the results when creating a basic linear model, due to Tobler’s first law of geography.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get linear model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>biodiv_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># attach resids to dataset</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>biodiversity <span class="ot">&lt;-</span> biodiversity <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp_pest_resid =</span> <span class="fu">resid</span>(biodiv_lm))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get centroids of each county polygon</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>bio_center <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(biodiversity)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># try and calculate spatial autocorrelation at 50 km</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>bee_nb <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(bio_center, <span class="at">d1 =</span> <span class="dv">0</span>, <span class="at">d2 =</span> <span class="dv">100000</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># assign weights to each neighboring object</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>bee_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(bee_nb, <span class="at">style =</span> <span class="st">'W'</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># get moran I</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>bee_resid_moran <span class="ot">&lt;-</span> <span class="fu">moran</span>(biodiversity<span class="sc">$</span>sp_pest_resid, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">listw =</span> bee_lw, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n =</span> <span class="fu">length</span>(bee_nb), </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">S0 =</span> <span class="fu">Szero</span>(bee_lw))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># run 999 simulations</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>bee_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(biodiversity<span class="sc">$</span>sp_pest_resid, bee_lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># running a lag model</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>lag_mod <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(bee_lw, biodiversity<span class="sc">$</span>sp_pest_resid)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># making lag model table</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">resids =</span> biodiversity<span class="sc">$</span>sp_pest_resid, <span class="at">neighborhood =</span> lag_mod)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># lag mod lm</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>lag_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(neighborhood <span class="sc">~</span> resids, <span class="at">data =</span> lag_mod_tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<img src="figs/simple_patchwork.png" title="Effect of Error Model." class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
Demonstration of spatial autocorrelation. On top, Moran’s I falls outside the range of the null distribution, while the residuals have a slight positive correlation with the spatial neighborhood. The bottom figures are plotted with a error model, remediating the autocorrelation.
</figcaption>
<p><br><br>
Because spatial autocorrelation is present, we create an error model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bio_err <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(sp_richness <span class="sc">~</span> kg_prd_used, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> biodiversity,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">listw =</span> bee_lw,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">na.action =</span> na.exclude, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bio_err)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We had run a lag model to correct for the autocorrelation. A lag model is a model in which the variables are offset step by step from one another, and that offset can be plotted on a figure with the lag on the x-axis, and the neighborhood on the y-axis. Variables that have autocorrelation between variables will hang for a while before hovering around the mean, whereas variables with no spatial autocorrelation nearly immediately begin hovering around the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add model and model residuals column to lag tibble</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">'error_mod'</span>) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> lag_mod_tib <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">error_mod =</span> <span class="fu">fitted</span>(bio_err), <span class="at">error_resid =</span> <span class="fu">resid</span>(bio_err))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># running a lag model with the error model</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>lag_mod_err <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(bee_lw, lag_mod_tib<span class="sc">$</span>error_resid)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get moran I for error model</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>err_moran <span class="ot">&lt;-</span> <span class="fu">moran</span>(lag_mod_tib<span class="sc">$</span>error_resid, <span class="at">listw =</span> bee_lw, <span class="at">n =</span> <span class="fu">length</span>(bee_nb), <span class="at">S0 =</span> <span class="fu">Szero</span>(bee_lw))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulation with error model</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>resid_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(lag_mod_tib<span class="sc">$</span>error_resid, bee_lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># add lag for error to tibble</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">'neighborhood_err'</span> <span class="sc">%in%</span> <span class="fu">names</span>(lag_mod_tib) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> lag_mod_tib <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">neighborhood_err =</span> lag_mod_err)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># run an lm to get p for errors neighborhood ~ resid</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>err_res_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(lag_mod_tib<span class="sc">$</span>neighborhood_err <span class="sc">~</span> lag_mod_tib<span class="sc">$</span>error_resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/final_fig.png" title="Pesticide Use vs Biodiversity in Error Model." class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<figcaption style="color:black;">
Pesticide used has been plotted against Biodiversity in a simple two variable linear model. The variables are not significant, but there is a slight negative slope.
</figcaption>
</section>
<section id="test-for-other-correlating-variables." class="level4">
<h4 class="anchored" data-anchor-id="test-for-other-correlating-variables.">4. Test for other correlating variables.</h4>
<p>Because the relationship between pesticide use and biodiversity was not found to be significant, I tested other variables. These variables are:</p>
<p><u>Habitat Fragmentation</u> <img src="hab_frag_test_lm.png" title="Linear model for habitat fragmentation vs biodiversity." class="img-fluid quarto-figure quarto-figure-center"></p>
<p><u>Population Density</u> <img src="pop_density_test_lm.png" title="Linear model for population density vs biodiversity." class="img-fluid quarto-figure quarto-figure-center"></p>
<p><u>Land Use</u> <img src="land_use_test_lm.png" title="Linear model for land use vs biodiversity." class="img-fluid quarto-figure quarto-figure-center"></p>
</section>
<section id="add-new-variable-to-model." class="level4">
<h4 class="anchored" data-anchor-id="add-new-variable-to-model.">5. Add new variable to model.</h4>
<p>Because land use was the most significantly correlated variable. I added it to the model:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="full_lm.png" title="Pesticide use vs biodiversity linear model with land use as an added variable." class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Land use as a variable is related to habitat fragmentation. In this analysis, we added it as a binary variable, separating the land types by habitat and non-habitat.</p>
<section id="our-new-model-is" class="level5">
<h5 class="anchored" data-anchor-id="our-new-model-is">Our new model is:</h5>
<p><span class="math display">\[\text{Species Richness} = {\beta}_0 + {\beta}_1\text{Pesticide Amount} + {\beta}_2\text{Land Use}\]</span></p>
<br> <img src="land_cover_lm.png" title="Biodiversity Against Pesticide Use and Land Cover" class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
Adding land use to the model, substantially increased the r<sup>2</sup> and made the p-value significant at p &lt; 0.01.
</figcaption>
</section>
</section>
<section id="spatial-autocorrelation-diagnosiserror-model-with-added-variable." class="level4">
<h4 class="anchored" data-anchor-id="spatial-autocorrelation-diagnosiserror-model-with-added-variable.">6. Spatial autocorrelation diagnosis/error model with added variable.</h4>
<p>The code and figures are very similar from before.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new lm w land cover</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>land_use_lm <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used <span class="sc">+</span> land_use, biodiversity))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># attaching resids of new lm to df</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>biodiversity <span class="ot">&lt;-</span> biodiversity <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp_pest_land_resid =</span> <span class="fu">resid</span>(land_use_lm))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get moran I again for the model with land cover</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>bee_resid_moran <span class="ot">&lt;-</span> <span class="fu">moran</span>(biodiversity<span class="sc">$</span>sp_pest_land_resid, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">listw =</span> bee_lw, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">n =</span> <span class="fu">length</span>(bee_nb), </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">S0 =</span> <span class="fu">Szero</span>(bee_lw))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run 999 simulations</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>bee_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(biodiversity<span class="sc">$</span>sp_pest_land_resid, bee_lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># running a lag model</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>lag_mod <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(bee_lw, biodiversity<span class="sc">$</span>sp_pest_land_resid)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># making lag model table</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">resids =</span> biodiversity<span class="sc">$</span>sp_pest_land_resid, <span class="at">neighborhood =</span> lag_mod)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co"># lag mod lm</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>lag_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(neighborhood <span class="sc">~</span> resids, <span class="at">data =</span> lag_mod_tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The neighborhood weighting from the previous error model is already suitable for this one so there’s no need to do it again.</p>
<p>There was possibly some autocorrelation. While the r<sup>2</sup> of the residuals is close to 0, the Moran’s I was still somewhat off from the null dist.</p>
<p>Making the error model and running the lag model:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bio_land_err <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(sp_richness <span class="sc">~</span> kg_prd_used <span class="sc">+</span> land_use, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> biodiversity,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw =</span> bee_lw,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action =</span> na.exclude, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bio_land_err)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add model and model residuals column to lag tibble</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">'error_mod_land'</span>) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> lag_mod_tib <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">error_mod_land =</span> <span class="fu">fitted</span>(bio_land_err), <span class="at">error_resid_land =</span> <span class="fu">resid</span>(bio_land_err))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># running a lag model with the error model</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>lag_mod_err <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(bee_lw, lag_mod_tib<span class="sc">$</span>error_resid_land)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get moran I for error model</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>err_moran <span class="ot">&lt;-</span> <span class="fu">moran</span>(lag_mod_tib<span class="sc">$</span>error_resid_land, <span class="at">listw =</span> bee_lw, <span class="at">n =</span> <span class="fu">length</span>(bee_nb), <span class="at">S0 =</span> <span class="fu">Szero</span>(bee_lw))</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulation with error model</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>resid_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(lag_mod_tib<span class="sc">$</span>error_resid_land, bee_lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># add lag for error to tibble</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">'neighborhood_err_land'</span> <span class="sc">%in%</span> <span class="fu">names</span>(lag_mod_tib) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>lag_mod_tib <span class="ot">&lt;-</span> lag_mod_tib <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">neighborhood_err_land =</span> lag_mod_err)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co"># run an lm to get p for errors neighborhood ~ resid</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>err_res_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(lag_mod_tib<span class="sc">$</span>neighborhood_err_land <span class="sc">~</span> lag_mod_tib<span class="sc">$</span>error_resid_land)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="final-figure" class="level3">
<h3 class="anchored" data-anchor-id="final-figure">Final Figure</h3>
<img src="figs/final_land_fig.png" title="Pesticide Use and Land Cover vs Biodiversity in Error Model" class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
A parallel slopes model for the effect of pesticide use and land cover on species richness. There is more biodiversity in habitat land types such as grasslands and forests than there are in non-habitat land types such as development. While the pesticide use variable was not significant, the land cover variable was. Species richness has been normalized by sample size.
</figcaption>
<p><br> While our relationship between pesticide use and biodiversity still was not significant, the relationship between biodiversity and land cover was. In this parallel slopes model, the difference between bee habitat land and non bee habitat land is distinct.</p>
<section id="fitting-a-loess-model." class="level4">
<h4 class="anchored" data-anchor-id="fitting-a-loess-model.">7. Fitting a loess model.</h4>
<p>Because the points for the model appear to follow an exponential decay curve, I decided a loess model potentially could be appropriate.</p>
<img src="figs/loess_model.png" title="Loess model for the parallel slopes model" class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
Loess model for our parallel slopes model between biodiversity, pesticide use, and land use.
</figcaption>
</section>
<section id="running-a-hypothesis-test." class="level4">
<h4 class="anchored" data-anchor-id="running-a-hypothesis-test.">8. Running a hypothesis test.</h4>
<p>Despite the result, I will still see if it was a product of chance or not.</p>
<ol type="1">
<li>Declare the hypothesis</li>
</ol>
<ul>
<li>H<sub>0</sub> = There is no significant effect of habitat on the relationship between biodiversity and pesticide use.</li>
<li>H<sub>A</sub> = There is a significant effect of habitat on the relationship between biodiversity and pesticide use.</li>
</ul>
<ol start="2" type="1">
<li>Obtain t-statistic</li>
</ol>
<ul>
<li>Our t-statistic is…
<ul>
<li>The difference in y-intercept for the model between habitat and non-habitat land.</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate land use values</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>biodiversity_hab <span class="ot">&lt;-</span> biodiversity <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(land_use <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>biodiversity_non_hab <span class="ot">&lt;-</span> biodiversity <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(land_use <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make linear models to get y ints from</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>hab_error <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity_hab)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>non_hab_error <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity_non_hab)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get y intercepts</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>t_st_hab <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(hab_error))[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>t_st_non_hab <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(non_hab_error))[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> t_st_hab <span class="sc">-</span> t_st_non_hab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="3" type="1">
<li>Run a randomization test</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>biodiversity_null <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># shuffle habitat in biodiversity</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>biodiversity_shuffle <span class="ot">&lt;-</span> biodiversity <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">land_use =</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(biodiversity), <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># separate land use values</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>biodiversity_hab <span class="ot">&lt;-</span> biodiversity_shuffle <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(land_use <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>biodiversity_non_hab <span class="ot">&lt;-</span> biodiversity_shuffle <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(land_use <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># make error models to get y ints from</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>hab_error <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity_hab)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>non_hab_error <span class="ot">&lt;-</span> <span class="fu">lm</span>(sp_richness <span class="sc">~</span> kg_prd_used, biodiversity_non_hab)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># get y intercepts</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>t_st_hab <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(hab_error))[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>t_st_non_hab <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(non_hab_error))[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> t_st_hab <span class="sc">-</span> t_st_non_hab</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Obtain p-value</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">sum</span>(biodiversity_null <span class="sc">&gt;</span> diff) <span class="sc">/</span><span class="fu">length</span>(biodiversity_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<img src="figs/hypothesis_test.png" title="Hypothesis Test Null Distribution" class="img-fluid quarto-figure quarto-figure-center">
<figcaption style="color:black;">
A histogram of a normal distribution for the randomization test. The difference in y intercept was obtained 1000 times when randomly shuffling the land cover variable.
</figcaption>
<p><br> 5. Accept or reject the null hypothesis</p>
<p>Because the p-value is significantly below p = 0.05, we can reject the null.</p>
<p>This is possibly an erroneous result, as it’s extremely unlikely for our t-statistic to be so far outside the null distribution.</p>
</section>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection">Reflection</h2>
<p>While I hypothesized that we would see a significant effect between biodiversity and pesticide use, we didn’t. There are several possible reasons for this.</p>
<section id="complexity-of-ecological-forces" class="level4">
<h4 class="anchored" data-anchor-id="complexity-of-ecological-forces">1. Complexity of ecological forces</h4>
<ul>
<li>While it remains true that bee populations are in decline, it’s also a somewhat complicated topic. For one, not all bee species are equally vulnerable. Bumblebee’s longer flight ranges and bigger bodies allow them to tough out the dredge of a long flight from one isolate habitat patch to another and the toxicity of pesticides better than honeybees do (Greenleaf et al, 2007). Furthermore, bees have shown to have a significant amount of phenotypic plasticity, in which they are able to modify their behavior according to their environment (Corona, Libbrecht, &amp; Wheeler, 2016). Furthermore, a significant amount of invasive pressure comes from other bees - the European Honeybee.</li>
</ul>
</section>
<section id="analysis-biases" class="level4">
<h4 class="anchored" data-anchor-id="analysis-biases">2. Analysis biases</h4>
<ul>
<li>Poor data precision
<ul>
<li>Disappointingly, the pesticide data, in spite of all it’s detail, did not have a column on it in order to join with the shapefile that came with it by township. This possibly affected the results of this analysis, as all the data, even if it was originally in great detail, had to be aggregated up to the county level.</li>
<li>The hypothesis test was notable as it was likely flawed. For one, I was not able to use an error model due to a strange error in the hypothesis test. Secondly, my p-statistic was suspiciously low.</li>
</ul></li>
</ul>
</section>
<section id="data-biases" class="level4">
<h4 class="anchored" data-anchor-id="data-biases">3. Data biases</h4>
<ul>
<li>Uneven distribution of data points
<ul>
<li>Big Bee, a database that contains data from a multitude of sources is unlikely to have it’s data be distributed evenly in space for if no other reason that data is more likely to be collected where people already are. It has many different partner and sources but it also collects research grade iNaturalist observations meaning it’s possible there will be less observations out in the middle of the desert and more in a popular park and picnic spot.</li>
</ul></li>
</ul>
</section>
</section>
<section id="possible-next-steps" class="level2">
<h2 class="anchored" data-anchor-id="possible-next-steps">Possible Next Steps</h2>
<p>Bee ecology and decline is a complex topic and there is still much left to learn. Ways I could continue this analysis include…</p>
<section id="refine-this-analysis-and-correct-possible-mistakes" class="level4">
<h4 class="anchored" data-anchor-id="refine-this-analysis-and-correct-possible-mistakes">1. Refine this analysis and correct possible mistakes</h4>
<ul>
<li>There are a multitude of ways this analysis could be improved.
<ul>
<li>How do we visualize the pesticide data with more precision? It’s possible there is something I missed, and the CA DPR may be able to help. Being about to accomplish this could lead to more interesting results than the ones obtained here.</li>
<li>Another possibility is to apply a logistic regression model to the land_cover variable. Because it’s the variable that appears to be most significantly correlated, it could be investigated further. Because it is such a high resolution dataset with many different land types, it may warrant it’s own analysis.</li>
</ul></li>
</ul>
</section>
<section id="investigate-other-variables" class="level4">
<h4 class="anchored" data-anchor-id="investigate-other-variables">2. Investigate other variables</h4>
<ul>
<li>Variables such as the influence of parasites and climate change are things that weren’t at all included in this analysis. Invasive parasites have been cited as being a notable contributor to colony collapse disorder (Meeus et al, 2011), and climate change continues to have it’s own negative effects (Soroye, Newbold, &amp; Kerr, 2020).</li>
</ul>
</section>
<section id="possible-interactions-with-non-bee-factors" class="level4">
<h4 class="anchored" data-anchor-id="possible-interactions-with-non-bee-factors">3. Possible interactions with non-bee factors</h4>
<ul>
<li>The environment is confusing and wild, and nothing will ever make sense to us but that makes it all the more beautiful. Of course, this won’t stop us from trying. Is sea level rise affecting a particular taxa’s favorite flower? Is there some stochastic connection between bee activity and monarch migration? These are things we can only know if they’re investigated.</li>
</ul>
</section>
</section>
</section>
<section id="citations" class="level1">
<h1>Citations</h1>
<section id="in-text" class="level3">
<h3 class="anchored" data-anchor-id="in-text">In Text</h3>
<p>Goulson, D., Nicholls, E., Botías, C., &amp; Rotheray, E. L. (2015). Bee declines driven by combined stress from parasites, pesticides, and lack of flowers. Science, 347(6229), 1255957.</p>
<p>California Department of Pesticide Regulation. (2023, January). PESTICIDE USE ANNUAL REPORT. https://www.cdpr.ca.gov/docs/pur/pur_history_background.pdf</p>
<p>Meeus, I., Brown, M. J. F., de Graaf, D. C., &amp; Smagghe, G. (2011). Effects of invasive parasites on bumble bee declines. Conservation Biology, 25(4), 662-671. https://doi.org/10.1111/j.1523-1739.2011.01707.x</p>
<p>Soroye, P., Newbold, T., &amp; Kerr, J. (2020). Climate change contributes to widespread declines among bumble bees across continents. Science, 367(6478), 685-688.</p>
<p>Aizen, M. A., &amp; Feinsinger, P. (1994). Habitat fragmentation, native insect pollinators, and feral honey bees in Argentine’Chaco Serrano’. Ecological applications, 4(2), 378-392.</p>
<p>Arena, M., &amp; Sgolastra, F. (2014). A meta-analysis comparing the sensitivity of bees to pesticides. Ecotoxicology, 23, 324-334.</p>
<p>Greenleaf, S. S., Williams, N. M., Winfree, R., &amp; Kremen, C. (2007). Bee foraging ranges and their relationship to body size. Oecologia, 153, 589-596.</p>
<p>Corona, M., Libbrecht, R., &amp; Wheeler, D. E. (2016). Molecular mechanisms of phenotypic plasticity in social insects. Current opinion in insect science, 13, 55-60.</p>
<p>Meeus, I., Brown, M. J., De Graaf, D. C., &amp; Smagghe, G. U. Y. (2011). Effects of invasive parasites on bumble bee declines. Conservation Biology, 25(4), 662-671.</p>
<p>Soroye, P., Newbold, T., &amp; Kerr, J. (2020). Climate change contributes to widespread declines among bumble bees across continents. Science, 367(6478), 685-688.</p>
</section>
<section id="data-1" class="level3">
<h3 class="anchored" data-anchor-id="data-1">Data</h3>
<p>Seltmann KC, Allen J, Brown BV, Carper A, Engel MS, Franz N, Gilbert E, Grinter C, Gonzalez VH, Horsley P, Lee S, Maier C, Miko I, Morris P, Oboyski P, Pierce NE, Poelen J, Scott VL, Smith M, Talamas EJ, Tsutsui ND, Tucker E (2021) Announcing Big-Bee: An initiative to promote understanding of bees through image and trait digitization. Biodiversity Information Science and Standards 5: e74037. https://doi.org/10.3897/biss.5.74037</p>
<p>California Department of Pesticide Regulation. (2017). Pesticide use reporting (PUR). California Environmental Protection Agency. Retrieved from https://www.cdpr.ca.gov/docs/pur/purmain.htm</p>
<p>U.S. Census Bureau (2024). County Population Totals and Components of Change: 2020-2023 Retrieved from https://www.census.gov/data/datasets/time-series/demo/popest/2020s-counties-total.html</p>
<p>Hoekstra, J. M., Molnar, J. L., Jennings, M., Revenga, C., Spalding, M. D., Boucher, T. M., Robertson, J. C., Heibel, T. J., &amp; Ellison, K. (2010). The atlas of global conservation: Changes, challenges, and opportunities to make a difference. J. L. Molnar (Ed.). Berkeley: University of California Press.</p>
<p>Earth Resources Observation and Science Center (2024). Annual National Land Cover Database. U.S. Geological Survey. Retrieved from https://www.usgs.gov/centers/eros/science/data-access</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{paul_cohen2024,
  author = {Paul Cohen, Joshua},
  title = {Pesticides and {Bee} {Biodiversity} at the {Golden} {Coast}},
  date = {2024-12-19},
  url = {https://silkiemoth.github.io/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-paul_cohen2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Paul Cohen, Joshua. 2024. <span>“Pesticides and Bee Biodiversity at the
Golden Coast.”</span> December 19, 2024. <a href="https://silkiemoth.github.io/">https://silkiemoth.github.io/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>No Copyright, Feel free to distribute.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <i class="fa-brands fa-github" title="the octocat github icon" aria-label="github"></i></p>
</div>
  </div>
</footer>




</body></html>